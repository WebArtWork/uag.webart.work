import{b as d}from"./chunk-CZEJVRH6.js";import{c as B}from"./chunk-IKSPIF3S.js";import{a as z}from"./chunk-3SNXAVZY.js";import{l as E,q as T,s as V,t as P}from"./chunk-KRWE5CTW.js";import{Ab as F,Bb as j,C as s,Ga as I,H as f,I as _,Ia as L,O as g,P as o,aa as v,ca as S,ga as M,ob as y,pb as k,r as p,tb as N,vb as x,wa as w,wb as r,xa as C,y as b,ya as D}from"./chunk-YWXTHJOJ.js";import{a as c}from"./chunk-CIWMVH6F.js";var U={formId:"phrase",title:"Phrase",components:[{name:"Input",key:"text",props:{label:"Origin text",placeholder:"Enter origin text...",type:"textarea",disabled:!0}},{name:"Input",key:"translation",focused:!0,props:{label:"Translation",placeholder:"Enter translation text...",type:"textarea"}}]};var u=(()=>{class n extends P{constructor(){super({name:"translatelanguage",unauthorized:!0}),this.language=g(void 0),this.languages=g(this.getDocs()),this._storeService=s(V),this._emitterService=s(T),this._languageId=g(null),this.loaded.subscribe({next:()=>{this.languages.set(this.getDocs()),this._loadLocal()}}),this.get().subscribe(()=>{this.languages.set(this.getDocs()),this._loadLocal()}),this._emitterService.on("translatelanguage_changed").subscribe(()=>{this.languages.set(this.getDocs())}),o(()=>{let e=this._languageId(),t=this.languages();if(!e||!t.length){this.language.set(void 0);return}let a=t.find(i=>i._id===e);a&&(this.language.set(a),this._storeService.set("languageId",e),this._emitterService.emit("languageId",e))})}setLanguageId(e=null){this._languageId.set(e)}setLanguage(e){e?._id&&this._languageId.set(e._id)}nextLanguage(){let e=this.getDocs();if(e.length>1){let t=this.language(),a=t?e.findIndex(i=>i._id===t._id):0;this.setLanguage(a===e.length-1?e[0]:e[a+1])}else this._languageId.set(null)}_loadLocal(){this._storeService.get("languageId",e=>{e&&this._languageId.set(e)})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var h={formId:"language",components:[{name:"Input",key:"name",focused:!0,props:{placeholder:"Enter language name ...",label:"Language name"}}]};var ie=(()=>{class n extends E{constructor(e){super(h,s(d),e,"language"),this.configType="local",this._languageService=s(u),this._form=s(d),this._cdr=s(j),this.searchable=r(!0),this.clearable=r(!0),this.disabled=r(!1),this.isMutatable=r(!1),this.wModel=F(null,{alias:"wModel"}),this.wChange=x(),this.placeholder=N(()=>(this.documents().length?"Select language":"Create new language")+"..."),this.buttons=g([]),this._languageService.loaded.pipe(p(1)).subscribe(()=>{this.setDocuments()}),o(()=>{if(this._languageService.language()?._id&&this.wModel.set(this._languageService.language()?._id),this.isMutatable()){let t=!!this._languageService.language()?._id;this.buttons.set([{icon:t?"edit":"",click:()=>this.mutate(!0)},{icon:t?"delete":"",click:()=>this.deleteCurrent()},{icon:"add",click:()=>this.mutate(!1)}])}this._cdr.markForCheck()})}mutate(e=!0){let t=this.wModel()??null,a=e?this._languageService.getSignal(t):void 0;this._form.modal(h,{label:e?"Update":"Create",click:(i,m)=>{e&&this._languageService.language()?this._languageService.update(c(c({},this._languageService.language()),i)).subscribe(()=>{this.setDocuments()}):this._languageService.create(i).subscribe(l=>{this.setDocuments(),this._languageService.setLanguage(l),this.wModel.set(l._id),this.wChange.emit(l._id)}),m()}},a?.())}deleteCurrent(){let e=this._languageService.language();e&&(this._languageService.languages().length>1?(this._languageService.nextLanguage(),console.log(this._languageService.language()),this.wModel.set(this._languageService.language()?._id)):this._languageService.setLanguageId(),this._languageService.delete(e).subscribe(()=>{this.setDocuments()}))}static{this.\u0275fac=function(t){return new(t||n)(v(u))}}static{this.\u0275cmp=S({type:n,selectors:[["language-selector"]],inputs:{searchable:[1,"searchable"],clearable:[1,"clearable"],disabled:[1,"disabled"],isMutatable:[1,"isMutatable"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[M],decls:2,vars:9,consts:[[3,"wChange","placeholder","disabled","searchable","clearable","buttons","wModel","items"]],template:function(t,a){if(t&1){let i=I();C(0,"wselect",0),y(1,"translate"),L("wChange",function(l){return f(i),a.wModel.set(l),_(a.wChange.emit(l))}),D()}if(t&2){let i=a.documents();w("placeholder",k(1,7,a.placeholder())())("disabled",a.disabled()||!i.length)("searchable",a.searchable())("clearable",a.clearable())("buttons",a.buttons())("wModel",a.wModel())("items",i)}},dependencies:[B,z],encapsulation:2,changeDetection:0})}}return n})();export{U as a,u as b,ie as c};
