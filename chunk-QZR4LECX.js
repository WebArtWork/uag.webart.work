import"./chunk-T6CMCPX7.js";import{b as O}from"./chunk-P6OYN4RW.js";import"./chunk-UMYXIEMT.js";import"./chunk-XMVVDJ4N.js";import"./chunk-A46T6KCN.js";import"./chunk-QDH4MIVX.js";import"./chunk-IKSPIF3S.js";import{c as V}from"./chunk-3SNXAVZY.js";import{a as S,b as P,c as x,f as p}from"./chunk-RB45GIYM.js";import"./chunk-UXH2HGWJ.js";import{a as N}from"./chunk-LKVIN4NJ.js";import{a as I}from"./chunk-KR3XK5MS.js";import"./chunk-XQJPQ7LG.js";import"./chunk-LB2I43TM.js";import{q as D,y as E}from"./chunk-KRWE5CTW.js";import{C as v,Ga as y,H as w,I as g,Ia as m,Ka as u,O as h,Xa as _,Y as i,ca as T,na as s,oa as a,qa as F,ra as k,tb as C,wa as d,xa as n,ya as l,za as c}from"./chunk-YWXTHJOJ.js";import{a as b,b as M}from"./chunk-CIWMVH6F.js";var z=x(r=>{p(r.name,{message:"Enter your name..."}),p(r.phone,{message:"Enter your phone..."}),p(r.bio,{message:"Enter your biography..."})}),A=x(r=>{p(r.currentPassword,{message:"Enter your current password..."}),p(r.newPassword,{message:"Enter your new password..."}),p(r.confirmPassword,{message:"Confirm your new password..."})});function j(r,U){if(r&1){let e=y();n(0,"div",5)(1,"ngx-file",7),m("wImageChange",function(t){w(e);let f=u();return g(f.updateThumb(t||""))}),l(),n(2,"form",8),m("submit",function(t){return w(e),u().wFormSubmit(),g(t.preventDefault())}),c(3,"winput",9),s(),c(4,"winput",10),s(),c(5,"winput",11),s(),n(6,"wbutton",12),_(7," Update "),l()()()}if(r&2){let e=u();i(),d("wImage",e.userService.thumb())("container","user")("name",e.userService.user()._id+".jpg")("accept","image/*")("clearable",!1)("preview",!0)("cropWidth",512)("cropHeight",512),i(2),a(e.profileForm.name),i(),a(e.profileForm.phone),i(),a(e.profileForm.bio),i(),d("disabled",e.isSubmitDisabled())}}function H(r,U){if(r&1){let e=y();n(0,"div",6)(1,"form",8),m("submit",function(t){return w(e),u().wSecuritySubmit(),g(t.preventDefault())}),c(2,"winput",13),s(),c(3,"winput",14),s(),c(4,"winput",15),s(),n(5,"wbutton",12),_(6," Update password "),l()()()}if(r&2){let e=u();i(2),a(e.securityForm.currentPassword),i(),a(e.securityForm.newPassword),i(),a(e.securityForm.confirmPassword),i(),d("disabled",e.isSecurityDisabled())}}var re=(()=>{class r{constructor(){this.userService=v(N),this._emitterService=v(D),this._alertService=v(I),this.activeTab=h("profile"),this.profileModel=h({name:this.userService.user().name||"",phone:this.userService.user().phone||"",bio:this.userService.user().bio||""}),this.profileForm=S(this.profileModel,z),this.isSubmitDisabled=C(()=>this.profileForm().invalid()),this.securityModel=h({currentPassword:"",newPassword:"",confirmPassword:""}),this.securityForm=S(this.securityModel,A),this.isSecurityDisabled=C(()=>this.securityForm().invalid()||this.securityModel().newPassword!==this.securityModel().confirmPassword),this._emitterService.onComplete("us.user").subscribe(()=>{let e=this.userService.user();this.profileModel.set({name:e.name||"",phone:e.phone||"",bio:e.bio||""}),this.profileForm().reset()})}setTab(e){this.activeTab.set(e)}wFormSubmit(){P(this.profileForm,e=>(this.userService.user.set(b(b({},this.userService.user()),e().value())),this.userService.updateMe(),Promise.resolve()))}wSecuritySubmit(){P(this.securityForm,e=>{let o=e().value();return this.userService.changePassword(o.currentPassword,o.newPassword).subscribe({next:()=>{this.securityForm().reset(),this.securityModel.set({currentPassword:"",newPassword:"",confirmPassword:""})}}),Promise.resolve()})}updateThumb(e){this.userService.user.set(M(b({},this.userService.user()),{thumb:e})),this.userService.thumb.set(e),this.userService.updateMe()}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275cmp=T({type:r,selectors:[["ng-component"]],decls:10,vars:5,consts:[[1,"profile","grid","g-4"],[1,"profile__card","shadow","rounded-card"],[1,"profile__tabs"],[1,"profile__tab",3,"click","type","isMultipleClicksAllowed"],[1,"profile__body"],[1,"profile__panel","profile__panel--profile"],[1,"profile__panel","profile__panel--security"],["mode","single-image","view","thumb-only",3,"wImageChange","wImage","container","name","accept","clearable","preview","cropWidth","cropHeight"],[1,"profile__fields","stack",3,"submit"],["placeholder","Enter your name...",3,"field"],["placeholder","Enter your phone...","type","tel",3,"field"],["placeholder","Enter your bio...","type","textarea",3,"field"],["type","primary",1,"mt-2",3,"disabled"],["placeholder","Enter your current password...","type","password",3,"field"],["placeholder","Enter your new password...","type","password",3,"field"],["placeholder","Confirm your new password...","type","password",3,"field"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"wbutton",3),m("click",function(){return t.setTab("profile")}),_(4," Profile "),l(),n(5,"wbutton",3),m("click",function(){return t.setTab("security")}),_(6," Security "),l()(),n(7,"div",4),F(8,j,8,15,"div",5)(9,H,7,7,"div",6),l()()()),o&2&&(i(3),d("type",t.activeTab()==="profile"?"primary":"link")("isMultipleClicksAllowed",!0),i(2),d("type",t.activeTab()==="security"?"primary":"link")("isMultipleClicksAllowed",!0),i(3),k(t.activeTab()==="profile"?8:9))},dependencies:[V,E,O],styles:[".profile[_ngcontent-%COMP%]{display:block}.profile__card[_ngcontent-%COMP%]{position:relative;inline-size:100%;max-inline-size:100%;background:var(--c-bg-secondary);padding:var(--sp-5) var(--sp-4);display:flex;flex-direction:column;gap:var(--sp-4)}.profile__tabs[_ngcontent-%COMP%]{display:flex;gap:var(--sp-3);border-bottom:1px solid var(--c-border);padding-bottom:var(--sp-3);margin-bottom:var(--sp-3)}.profile__tab[_ngcontent-%COMP%]{border:0;background:transparent;color:var(--c-text-secondary);font-weight:600;font-size:.9rem;padding:var(--sp-1_5) var(--sp-3);border-radius:var(--b-radius-btn);cursor:pointer;transition:background-color var(--motion) var(--easing),color var(--motion) var(--easing)}.profile__tab[_ngcontent-%COMP%]:focus-visible{outline:none;box-shadow:var(--focus-ring)}.profile__body[_ngcontent-%COMP%], .profile__panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--sp-3)}.profile__fields[_ngcontent-%COMP%]   .winput__field[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--c-border);border-radius:var(--b-radius);color:var(--c-text-secondary);transition:border-color var(--motion) var(--easing)}.profile__fields[_ngcontent-%COMP%]   .winput__field[_ngcontent-%COMP%]:focus-within{border-color:var(--c-primary)}.profile__fields[_ngcontent-%COMP%]   .wbutton[_ngcontent-%COMP%]{min-block-size:42px;border-radius:var(--b-radius-btn);font-weight:600}@media(max-width:991.9px){.profile[_ngcontent-%COMP%]{padding:var(--sp-3)}.profile__card[_ngcontent-%COMP%]{padding:var(--sp-4)}}"],changeDetection:0})}}return r})();export{re as ProfileComponent};
